# Защита SSH сервера

## Описание
Защита SSH сервера от атак и взлома: анализ логов и пакетов для обнаружения сканирования, настройка SSH (изменение порта, авторизация по ключам), защита от подбора паролей, настройка двухфакторной аутентификации (2FA).

## Уровень
Средний

## Примеры использования

### Анализ логов и обнаружение атак
- Просмотр журнала событий для анализа попыток аутентификации.
- Анализ пакетов с помощью TCPdump для выявления сканирования портов.
- Признаки сканирования: пакеты с флагом SYN, но без ICMP.
- Мониторинг подозрительной активности в логах SSH.

### Базовые меры безопасности
- Обновление пакетов системы для устранения уязвимостей.
- Создание новых пользователей вместо использования root.
- Добавление пользователей в группу sudo для выполнения административных команд.
- Ограничение доступа к root аккаунту.

### Настройка SSH

#### Изменение стандартного порта
- Изменение порта SSH с 22 на нестандартный для усложнения автоматического сканирования.
- Обновление конфигурации SSH (`/etc/ssh/sshd_config`).

#### Авторизация по ключам
- Создание директории SSH для хранения ключей: `~/.ssh/`.
- Установка правильных прав доступа на директорию и файлы ключей.
- Генерация публичных и приватных ключей на клиенте и сервере.
- Отключение входа по паролю и настройка авторизации только по ключу.
- Использование сильных ключей (RSA 2048+ или Ed25519).

### Защита от подбора паролей
- Отключение аутентификации по паролю.
- Использование fail2ban для блокировки IP после неудачных попыток входа.
- Ограничение количества попыток аутентификации.
- Мониторинг попыток брутфорса в логах.

### Двухфакторная аутентификация (2FA)
- Установка пакета для двухфакторной аутентификации (Google Authenticator PAM).
- Настройка секретного ключа и генерация QR-кода.
- Настройка в приложении Google Authenticator на мобильном устройстве.
- Подключение пакета для двухфакторной аутентификации в конфигурации SSH.
- Перезапуск SSH и проверка работы двухфакторной аутентификации.
- Вход с использованием временного кода из приложения.

### Дополнительные меры защиты
- Ограничение доступа по IP-адресам (если возможно).
- Использование VPN для доступа к SSH.
- Регулярный мониторинг логов и обновление системы.
- Отключение неиспользуемых функций SSH.

## Ресурсы для изучения
- SSH конфигурация и безопасность
- Google Authenticator для двухфакторной аутентификации
- fail2ban для защиты от брутфорса
- Методики анализа логов SSH
- Best practices для защиты SSH серверов

## Заметки
(Добавляйте свои заметки, примеры кода или ссылки на видео.)

